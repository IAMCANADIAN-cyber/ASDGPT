# Configuration Reference

This document provides a comprehensive reference for all configuration options in ASDGPT.

## Overview

The system loads configuration in the following priority order (highest to lowest):
1.  **Environment Variables**: Set via `.env` file or shell export. Useful for secrets (API keys) or temporary overrides.
2.  **User Configuration**: `user_data/config.json`. The recommended way to persist your settings.
3.  **Calibration Data**: `user_data/calibration.json`. Automatically generated by calibration tools for specific hardware thresholds.
4.  **Default Values**: Hardcoded in `config.py`.

## Configuration Files

*   **`user_data/config.json`**: Create this file to override defaults. It should be a valid JSON object.
    ```json
    {
      "PERFORMANCE_MODE": "low",
      "TTS_ENGINE": "coqui"
    }
    ```
*   **`.env`**: Use this for API keys and sensitive data.
    ```bash
    GOOGLE_API_KEY=your_api_key_here
    ```

## Core Settings

| Key | Default | Description |
| :--- | :--- | :--- |
| `APP_NAME` | "ACR" | Application name used in logs. |
| `LOG_LEVEL` | "INFO" | Logging verbosity (DEBUG, INFO, WARNING, ERROR). |
| `LOG_FILE` | "acr_app.log" | Path to the log file. |
| `DEFAULT_MODE` | "active" | Startup mode (active, snoozed, paused). |
| `SNOOZE_DURATION` | 3600 | Duration (seconds) for snooze mode. |
| `PERFORMANCE_MODE` | "high" | "high" (responsive) or "low" (eco/battery saver). |

## Hardware & Sensors

| Key | Default | Description |
| :--- | :--- | :--- |
| `CAMERA_INDEX` | 0 | Index of the webcam to use (0, 1, etc.). |
| `AUDIO_THRESHOLD_HIGH` | 0.5 | RMS amplitude to trigger "Loud Audio" events. |
| `VIDEO_ACTIVITY_THRESHOLD_HIGH` | 20.0 | Motion score to trigger "High Activity" events. |
| `VIDEO_WAKE_THRESHOLD` | 5.0 | Motion score required to wake from Eco Mode sleep. |
| `VAD_SILENCE_THRESHOLD` | 0.01 | RMS threshold to consider audio as "silence". |
| `VAD_WEAK_THRESHOLD` | 0.4 | Confidence threshold for weak speech detection. |
| `VAD_STRONG_THRESHOLD` | 0.7 | Confidence threshold for strong speech detection. |

### Video Polling & Eco Mode

These settings control the trade-off between responsiveness and CPU usage (Deep Eco Mode).

| Key | Default | Description |
| :--- | :--- | :--- |
| `VIDEO_ACTIVE_DELAY` | 0.05 | Seconds between frames when active (approx 20 FPS). |
| `VIDEO_ECO_MODE_DELAY` | 0.2 | Seconds between frames in Eco Mode (approx 5 FPS). |
| `VIDEO_ECO_HEARTBEAT_INTERVAL` | 1.0 | Max seconds between face checks in deep sleep. |

## Logic & Behavior

| Key | Default | Description |
| :--- | :--- | :--- |
| `MEETING_MODE_SPEECH_DURATION_THRESHOLD` | 3.0 | Seconds of continuous speech to trigger Meeting Mode. |
| `MEETING_MODE_IDLE_KEYBOARD_THRESHOLD` | 10.0 | Seconds of no keyboard input required for Meeting Mode. |
| `MEETING_MODE_SPEECH_GRACE_PERIOD` | 2.0 | Seconds of silence allowed before ending a speech segment. |
| `DOOM_SCROLL_THRESHOLD` | 3 | Number of "phone_usage" context tags to trigger intervention. |
| `REFLEXIVE_WINDOW_TRIGGERS` | (See config.py) | Map of window titles (e.g., "Steam") to intervention IDs. |
| `REFLEXIVE_WINDOW_COOLDOWN` | 300 | Seconds before a reflexive trigger can fire again. |

### Context History

| Key | Default | Description |
| :--- | :--- | :--- |
| `HISTORY_SAMPLE_INTERVAL` | 10 | Seconds between history snapshots. |
| `HISTORY_WINDOW_SIZE` | 5 | Number of snapshots to keep for LMM context. |
| `RAPID_SWITCHING_THRESHOLD` | 4 | Number of unique windows in history to trigger alert. |

## Focus & Distraction

Configure lists of applications to automatically classify activities.

| Key | Type | Description |
| :--- | :--- | :--- |
| `DISTRACTION_APPS` | List[str] | List of window titles that trigger a distraction alert. |
| `FOCUS_APPS` | List[str] | List of window titles that are considered "safe" and suppress distraction checks. |

### Example `user_data/config.json` with Lists

```json
{
  "DISTRACTION_APPS": [
    "Steam",
    "Reddit",
    "Twitter",
    "Facebook",
    "Instagram",
    "Civilization",
    "Minecraft"
  ],
  "FOCUS_APPS": [
    "VS Code",
    "Visual Studio",
    "PyCharm",
    "Word",
    "Excel",
    "Notion",
    "Obsidian"
  ],
  "REFLEXIVE_WINDOW_TRIGGERS": {
    "Specific Game": "force_shutdown_simulation",
    "My Budget": "budget_reminder"
  }
}
```

## Integrations

### LMM (Large Multi-modal Model)
| Key | Default | Description |
| :--- | :--- | :--- |
| `LOCAL_LLM_URL` | "http://127.0.0.1:1234" | URL for the local LLM API (OpenAI compatible). |
| `LOCAL_LLM_MODEL_ID` | "deepseek..." | Model ID string to request. |
| `LMM_FALLBACK_ENABLED` | True | Enable heuristic fallback if LMM fails. |

### Text-to-Speech (TTS)
| Key | Default | Description |
| :--- | :--- | :--- |
| `TTS_ENGINE` | "system" | "system" (pyttsx3) or "coqui" (XTTS). |
| `TTS_VOICE_ID` | None | Specific voice ID for system TTS. |
| `TTS_MODEL_NAME` | "tts_models..." | Model name for Coqui TTS (XTTS v2 default). |
| `TTS_VOICE_CLONE_SOURCE` | None | Path to WAV file for voice cloning (Coqui only). |

### Music Control
| Key | Default | Description |
| :--- | :--- | :--- |
| `ENABLE_MUSIC_CONTROL` | False | Enable Spotify/Music integration based on mood. |

### Erotic Content & Privacy
| Key | Default | Description |
| :--- | :--- | :--- |
| `EROTIC_CONTENT_OUTPUT_DIR` | "captures/erotic" | Directory to save captured content. |
| `SEXUAL_AROUSAL_THRESHOLD` | 50 | 0-100 threshold to enter sexual arousal state. |
| `SENSITIVE_APP_KEYWORDS` | (List) | Window titles containing these will be redacted. |

## Hotkeys

| Function | Default Key | Description |
| :--- | :--- | :--- |
| **Cycle Mode** | `ctrl+alt+m` | Switch between Active, Snoozed, Paused. |
| **Pause/Resume** | `ctrl+alt+p` | Toggle pause state. |
| **Feedback Helpful** | `ctrl+alt+up` | Mark last intervention as helpful. |
| **Feedback Unhelpful** | `ctrl+alt+down` | Mark last intervention as unhelpful. |

## How to Verify Configuration

### 1. Using the GUI Tool
Run the included configuration tool to view and edit `user_data/config.json` visually:
```bash
python tools/config_gui.py
```
*   **Verify**: Change a value (e.g., "Audio Threshold"), save, and check `user_data/config.json` to confirm the change.

### 2. Checking Logs
Start the application and check the startup logs:
```bash
python main.py
```
*   **Verify**: Look for lines like `ACR Initialized. Mode: active.` and `Hotkeys registered...`.
*   **Verify**: If you changed `LOG_LEVEL` to `DEBUG`, ensure verbose logs appear.
